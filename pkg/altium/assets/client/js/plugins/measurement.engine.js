"use strict";(self.webpackChunkaltium_web_viewer=self.webpackChunkaltium_web_viewer||[]).push([[7677,74687,11903,318],{2929:(e,t,r)=>{var n=r(31564),o=r(66675);function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}function u(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,a(n.key),n)}}function a(e){var t=function(e,t){if("object"!=i(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!=i(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==i(t)?t:t+""}var s=function(){return e=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.workspace=t},(t=[{key:"setCursor",value:function(e){var t=this;setTimeout((function(){switch(e){case n.E.None:t.workspace.style.cursor="none";break;case n.E.Wait:t.workspace.style.cursor="wait";break;case n.E.Cross:t.workspace.style.cursor=t.buildCursor(t.crossCursor);break;case n.E.Box:t.workspace.style.cursor=t.buildCursor(t.squareCursor);break;case n.E.Circle:t.workspace.style.cursor=t.buildCursor(t.circleCursor);break;case n.E.Triangle:t.workspace.style.cursor=t.buildCursor(t.triangleCursor);break;default:t.workspace.style.cursor="default"}}),1)}},{key:"circleCursor",get:function(){return'<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" fill="none" viewBox="0 0 32 32"><g fill-rule="evenodd" clip-rule="evenodd" filter="url(%23a)"><path fill="#%23000" d="M15.5 7 25 23H6l9.5-16Zm-4.23 13 4.23-7.124L19.73 20h-8.46Z"/><path fill="%23fff" d="M7.757 22 15.5 8.959 23.243 22H7.757Zm1.756-1h11.973L15.5 10.917 9.513 21Z"/></g><defs><filter id="a" width="25" height="22" x="3" y="5" color-interpolation-filters="sRGB" filterUnits="userSpaceOnUse"><feFlood flood-opacity="0" result="BackgroundImageFix"/><feColorMatrix in="SourceAlpha" result="hardAlpha" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"/><feOffset dy="1"/><feGaussianBlur stdDeviation="1.5"/><feColorMatrix values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.35 0"/><feBlend in2="BackgroundImageFix" result="effect1_dropShadow_39620_42157"/><feBlend in="SourceGraphic" in2="effect1_dropShadow_39620_42157" result="shape"/></filter></defs></svg>'}},{key:"crossCursor",get:function(){return'<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" fill="none" viewBox="0 0 32 32"><g filter="url(%23a)"><path fill="%23000" d="M17 14V7h-3v7H7v3h7v7h3v-7h7v-3h-7Z"/><path fill="%23fff" d="M16 15V8h-1v7H8v1h7v7h1v-7h7v-1h-7Z"/></g><defs><filter id="a" width="23" height="23" x="4" y="5" color-interpolation-filters="sRGB" filterUnits="userSpaceOnUse"><feFlood flood-opacity="0" result="BackgroundImageFix"/><feColorMatrix in="SourceAlpha" result="hardAlpha" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"/><feOffset dy="1"/><feGaussianBlur stdDeviation="1.5"/><feColorMatrix values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.35 0"/><feBlend in2="BackgroundImageFix" result="effect1_dropShadow_419_3940"/><feBlend in="SourceGraphic" in2="effect1_dropShadow_419_3940" result="shape"/></filter></defs></svg>'}},{key:"squareCursor",get:function(){return'<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" fill="none" viewBox="0 0 32 32"><g fill-rule="evenodd" clip-rule="evenodd" filter="url(%23a)"><path fill="%23fff" d="M8 8h15v15H8V8Zm3 3h9v9h-9v-9Z"/><path fill="%23000" d="M10 10v11h11V10H10Zm1 1h9v9h-9v-9Z"/><path fill="%23000" d="M8 8v15h15V8H8Zm1 1h13v13H9V9Z"/></g><defs><filter id="a" width="21" height="21" x="5" y="6" color-interpolation-filters="sRGB" filterUnits="userSpaceOnUse"><feFlood flood-opacity="0" result="BackgroundImageFix"/><feColorMatrix in="SourceAlpha" result="hardAlpha" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"/><feOffset dy="1"/><feGaussianBlur stdDeviation="1.5"/><feColorMatrix values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.35 0"/><feBlend in2="BackgroundImageFix" result="effect1_dropShadow_39616_8717"/><feBlend in="SourceGraphic" in2="effect1_dropShadow_39616_8717" result="shape"/></filter></defs></svg>'}},{key:"triangleCursor",get:function(){return'<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" fill="none" viewBox="0 0 32 32"><g fill-rule="evenodd" clip-rule="evenodd" filter="url(%23a)"><path fill="#%23000" d="M15.5 7 25 23H6l9.5-16Zm-4.23 13 4.23-7.124L19.73 20h-8.46Z"/><path fill="%23fff" d="M7.757 22 15.5 8.959 23.243 22H7.757Zm1.756-1h11.973L15.5 10.917 9.513 21Z"/></g><defs><filter id="a" width="25" height="22" x="3" y="5" color-interpolation-filters="sRGB" filterUnits="userSpaceOnUse"><feFlood flood-opacity="0" result="BackgroundImageFix"/><feColorMatrix in="SourceAlpha" result="hardAlpha" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"/><feOffset dy="1"/><feGaussianBlur stdDeviation="1.5"/><feColorMatrix values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.35 0"/><feBlend in2="BackgroundImageFix" result="effect1_dropShadow_39620_42157"/><feBlend in="SourceGraphic" in2="effect1_dropShadow_39620_42157" result="shape"/></filter></defs></svg>'}},{key:"buildCursor",value:function(e){return"url('data:image/svg+xml;utf8,".concat(e,"') 16 16, auto")}}])&&u(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}();function c(e){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c(e)}function l(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,f(n.key),n)}}function f(e){var t=function(e,t){if("object"!=c(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!=c(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==c(t)?t:t+""}var h=function(){return function(e,t,r){return r&&l(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}((function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}),0,[{key:"createElement",value:function(e){return document.createElementNS("http://www.w3.org/2000/svg",e)}},{key:"setAttribute",value:function(e,t){for(var r in t)e.setAttribute(r,t[r.toString()]);return e}},{key:"createLeftRoundedRectPath",value:function(e,t,r,n,o){return"M"+(e+o)+","+t+"h"+(r-o)+"v"+n+"h"+(o-r)+"a"+o+","+o+" 0 0 1 "+-o+","+-o+"v"+(2*o-n)+"a"+o+","+o+" 0 0 1 "+o+","+-o+"z"}},{key:"createRightRoundedRectPath",value:function(e,t,r,n,o){return"M"+e+","+t+"h"+(r-o)+"a"+o+","+o+" 0 0 1 "+o+","+o+"v"+(n-2*o)+"a"+o+","+o+" 0 0 1 "+-o+","+o+"h"+(o-r)+"z"}}])}();function m(e){return m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},m(e)}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function y(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,p(n.key),n)}}function p(e){var t=function(e,t){if("object"!=m(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!=m(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==m(t)?t:t+""}function v(e,t,r){return t=g(t),function(e,t){if(t&&("object"==m(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,b()?Reflect.construct(t,r||[],g(e).constructor):t.apply(e,r))}function b(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(b=function(){return!!e})()}function g(e){return g=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},g(e)}function w(e,t){return w=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},w(e,t)}var E=["mousedown","mouseup","mousemove","mouseleave","mouseenter","touchstart","touchmove","touchend","click","dblclick"],I=function(e){function t(e){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(r=v(this,t)).overlay=h.createElement("g"),h.setAttribute(r.overlay,{id:"measurements"}),e.appendChild(r.overlay),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&w(e,t)}(t,e),function(e,t,r){return t&&y(e.prototype,t),r&&y(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}(t,[{key:"labelXY",get:function(){return this._labelXY}},{key:"labelX",get:function(){return this._labelX}},{key:"labelY",get:function(){return this._labelY}},{key:"activate",value:function(){h.setAttribute(this.overlay,{style:"visibility: visible"})}},{key:"deactivate",value:function(){h.setAttribute(this.overlay,{style:"visibility: hidden"})}},{key:"moveLabelXY",value:function(e,t,r,n){if(this._labelXY){var o=this._labelXY,i=o.children.item(0),u=this.getLabelVec(e,t),a="rotate(0)";h.setAttribute(o,{transform:a});var s=Math.round(u.from[0]),c=Math.round(u.from[1]);if(Number.isFinite(s)&&Number.isFinite(c)){this.moveLabelInfo(i,{label:"XY",value:r,units:n});var l=o.getBBox(),f=l.width/2,m=l.height/2,d=l.width,y=this.getMeterLength(e,t);y<2*d&&this.hideProjections(),y<1.5*d&&(m+=l.height);var p=this.getMeterDegrees(e,t);a="translate(".concat(s,",").concat(c,") rotate(").concat(p,") translate(").concat(-f,", ").concat(-m,")"),h.setAttribute(o,{transform:a})}}}},{key:"moveLabelX",value:function(e,r,n,o){if(this._labelX){var i=t.getXProjection(e,r),u=this._labelX,a=u.children.item(0);this.moveLabelInfo(a,{label:"X",value:n,units:o});var s=this.getLabelVec(i.from,i.to),c=u.getBBox(),l=Math.round(s.from[0]-c.width/2),f=Math.round(s.from[1]-c.height/2);if(Number.isFinite(l)&&Number.isFinite(f)){var m=c.width;this.getMeterLength(i.from,i.to)<1.5*m&&(f=e[1]>r[1]?f+c.height:f-c.height);var d="translate(".concat(l,",").concat(f,")");h.setAttribute(u,{transform:d})}}}},{key:"moveLabelY",value:function(e,r,n,o){if(this._labelY){var i=t.getYProjection(e,r),u=this._labelY,a=u.children.item(0),s="rotate(0)";h.setAttribute(u,{transform:s}),this.moveLabelInfo(a,{label:"Y",value:n,units:o});var c=this.getLabelVec(i.from,i.to),l=u.getBBox(),f=Math.round(c.from[0]),m=Math.round(c.from[1]);if(Number.isFinite(f)&&Number.isFinite(m)){var d=l.width/2,y=l.height/2,p=l.width;this.getMeterLength(i.from,i.to)<1.5*p&&(y=e[0]>r[0]?y+l.height:y-l.height),s="translate(".concat(f,",").concat(m,") rotate(-90) translate(").concat(-d,", ").concat(-y,")"),h.setAttribute(u,{transform:s})}}}},{key:"attachEvents",value:function(e){var t=this;E.forEach((function(r){return e.addEventListener(r,t.stopEvents,!0)}))}},{key:"createLabelXY",value:function(e,t,r,n){var o=this;this._labelXY=this.getLabelTemplateXY(e,t,"XY",r,n),h.setAttribute(this._labelXY,{id:"labelXY"}),this._labelXY.addEventListener("click",(function(){return o.emit("click")}),!0),this._labelXY.addEventListener("touchend",(function(){return o.emit("click")}),!0),this.attachEvents(this._labelXY),this.overlay.appendChild(this._labelXY)}},{key:"createLabelX",value:function(e,r,n,o){var i=t.getXProjection(e,r);this._labelX=this.getLabelTemplateX(i.from,i.to,"X",n,o),h.setAttribute(this._labelX,{id:"labelX",style:"visibility: hidden"}),this.attachEvents(this._labelX),this.overlay.appendChild(this._labelX)}},{key:"createLabelY",value:function(e,r,n,o){var i=t.getYProjection(e,r);this._labelY=this.getLabelTemplateY(i.from,i.to,"Y",n,o),h.setAttribute(this._labelY,{id:"labelY",style:"visibility: hidden"}),this.attachEvents(this._labelY),this.overlay.appendChild(this._labelY)}},{key:"showLabel",value:function(){this._labelXY&&h.setAttribute(this._labelXY,{style:"visibility: visible; cursor: pointer;"})}},{key:"hideLabel",value:function(){this._labelXY&&h.setAttribute(this._labelXY,{style:"visibility: hidden"})}},{key:"showProjections",value:function(){this._labelX&&(h.setAttribute(this._labelX,{style:"visibility: visible; cursor: default;"}),h.setAttribute(this._labelY,{style:"visibility: visible; cursor: default;"}))}},{key:"hideProjections",value:function(){this._labelX&&(h.setAttribute(this._labelX,{style:"visibility: hidden"}),h.setAttribute(this._labelY,{style:"visibility: hidden"}))}},{key:"dispose",value:function(){var e,t,r,n;null===(e=this._labelXY)||void 0===e||e.remove(),null===(t=this._labelX)||void 0===t||t.remove(),null===(r=this._labelY)||void 0===r||r.remove(),null===(n=this.overlay.parentNode)||void 0===n||n.removeChild(this.overlay)}},{key:"stopEvents",value:function(e){e.preventDefault(),e.stopPropagation()}},{key:"getMeterDegrees",value:function(e,t){var r=t[1]-e[1],n=t[0]-e[0],o=180*Math.atan2(r,n)/Math.PI;return o>-90&&o<90?o:o>=90&&o<=180?o-180:o+180}},{key:"getMeterLength",value:function(e,t){return Math.sqrt(Math.pow(e[0]-t[0],2)+Math.pow(e[1]-t[1],2))}},{key:"getLabelVec",value:function(e,t){var r=t[0]-e[0],n=t[1]-e[1],o=Math.sqrt(Math.pow(r,2)+Math.pow(n,2))||1,i=-n/o,u=r/o,a=Math.PI/2,s=Math.atan2(n,r),c=-Math.PI/6;s>0&&s<a&&(c+=Math.PI),s>=a&&s<Math.PI&&(c=Math.PI-c),s<0&&s>-Math.PI&&(c=-c),s<0&&s>-a&&(c+=Math.PI);var l=[e[0]+.5*r,e[1]+.5*n];return{from:l,to:[l[0]+30*(i*Math.cos(c)-u*Math.sin(c)),l[1]+30*(i*Math.sin(c)+u*Math.cos(c))]}}},{key:"getLabelBaseTemplate",value:function(e,t,r){var n=h.createElement("g"),o=h.createElement("rect"),i=h.createElement("text");i.textContent="".concat(t.toFixed(2)).concat(r);var u=i.getBoundingClientRect();return h.setAttribute(i,{x:5,y:.9*u.height,fill:"black"}),h.setAttribute(o,{x:0,y:0,rx:4,ry:4,width:u.width+10,height:u.height+5,fill:"white",stroke:"black","stroke-width":1}),n.appendChild(o),n.appendChild(i),n}},{key:"getLabelTemplateXY",value:function(e,t,r,n,o){var i=h.createElement("g"),u=this.getLabelVec(e,t),a=this.getLabelBaseTemplate(r,n,o);i.appendChild(a);var s=i.getBBox(),c=u.from[0]-s.width/2,l=u.from[1]-s.height/2,f="translate(".concat(c,",").concat(l,")");return h.setAttribute(i,{transform:f}),i}},{key:"getLabelTemplateX",value:function(e,t,r,n,o){var i=h.createElement("g"),u=this.getLabelVec(e,t),a=this.getLabelBaseTemplate(r,n,o),s="translate(".concat(u.from[0],",").concat(u.from[1],")");return h.setAttribute(i,{transform:s}),i.appendChild(a),i}},{key:"getLabelTemplateY",value:function(e,t,r,n,o){var i=h.createElement("g"),u=this.getLabelVec(e,t),a=this.getLabelBaseTemplate(r,n,o),s="translate(".concat(u.from[0],",").concat(u.from[1],")");return h.setAttribute(i,{transform:s}),i.appendChild(a),i}},{key:"moveLabelInfo",value:function(e,t){var r,n,o=(r=Array.from(e.children),n=2,function(e){if(Array.isArray(e))return e}(r)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,i,u,a=[],s=!0,c=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(a.push(n.value),a.length!==t);s=!0);}catch(e){c=!0,o=e}finally{try{if(!s&&null!=r.return&&(u=r.return(),Object(u)!==u))return}finally{if(c)throw o}}return a}}(r,n)||function(e,t){if(e){if("string"==typeof e)return d(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?d(e,t):void 0}}(r,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),i=o[0],u=o[1];u.textContent="".concat(t.value.toFixed(2)).concat(t.units);var a=u.getBoundingClientRect();h.setAttribute(u,{x:5,y:.9*a.height}),h.setAttribute(i,{x:0,width:a.width+10,height:a.height+5})}}],[{key:"getXProjection",value:function(e,t){return{from:e,to:[t[0],e[1],t[2]]}}},{key:"getYProjection",value:function(e,t){return{from:[t[0],e[1],e[2]],to:t}}}])}(o.Z);function S(e){return S="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},S(e)}function _(e){return function(e){if(Array.isArray(e))return C(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return C(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?C(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function C(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function k(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,O(n.key),n)}}function O(e){var t=function(e,t){if("object"!=S(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!=S(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==S(t)?t:t+""}var P=function(){return e=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.layer=t,this.arcs=new Array,this.labels=new Array,this.lines=new Array,this.polygons=new Array,this.unis=new Array},(t=[{key:"isEmpty",get:function(){return!(this.arcs.length||this.labels.length||this.lines.length||this.polygons.length||this.unis.length)}},{key:"add",value:function(e){var t,r,n,o,i;(t=this.arcs).push.apply(t,_(e.arcs)),(r=this.labels).push.apply(r,_(e.labels)),(n=this.lines).push.apply(n,_(e.lines)),(o=this.polygons).push.apply(o,_(e.polygons)),(i=this.unis).push.apply(i,_(e.unis))}},{key:"clear",value:function(){return this.arcs.length=0,this.labels.length=0,this.lines.length=0,this.polygons.length=0,this.unis.length=0,this}},{key:"toLayerGeometryBuildInfo",value:function(){var e=this.layer,t=this.arcs.slice(),r=this.labels.slice(),n=this.lines.slice(),o=this.polygons.slice(),i=this.unis.slice();return{GetLayerIndex:function(){return e},GetArcs:function(){return t},GetLabels:function(){return r},GetLines:function(){return n},GetPolygons:function(){return o},GetUnis:function(){return i}}}}])&&k(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}();function M(e){return M="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},M(e)}function j(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function x(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,B(n.key),n)}}function A(e,t,r){return t&&x(e.prototype,t),r&&x(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function B(e){var t=function(e,t){if("object"!=M(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!=M(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==M(t)?t:t+""}var T=function(){return A((function e(t,r,n,o,i,u){j(this,e),this.pixelBoundSize=n,this.pixelLineWidth=o,this.pixelRadius=i,this.materialId=this.initMaterial(t,r,u)}),[{key:"update",value:function(e){this.uniBoundSize=this.pixelBoundSize*e,this.uniLineWidth=this.pixelLineWidth*e,this.uniRadius=this.pixelRadius*e}},{key:"initMaterial",value:function(e,t,r){return e.add2DMaterial(t.createMaterial(Uint8Array.from(r)))}}])}(),L=function(){return A((function e(t,r){j(this,e),this.scene=t,this.provider=r,this.nodeContainer=new P(0),this.bottom=new T(t,r,16,3.5,8,[0,0,0,255]),this.top=new T(t,r,14,1.5,8,[255,255,255,255])}),[{key:"build",value:function(e,t,r,n){this.updateStyles();var o=this.getLineTemplate(t.from,t.to);if(e.add(o),!n){var i=this.getCapTemplate(t.from);e.add(i);var u=void 0!==r?this.getCustomCursorTemplate(t.to,r):this.getCapTemplate(t.to);e.add(u)}}},{key:"buildCursor",value:function(e,t,r){this.updateStyles();var n=void 0!==r?this.getCustomCursorTemplate(t,r):this.getCursorTemplate(t);e.add(n)}},{key:"getCapTemplate",value:function(e){return this.nodeContainer.clear()}},{key:"getCursorTemplate",value:function(e){return this.nodeContainer.clear()}},{key:"getLineTemplate",value:function(e,t){e=this.toVector3(e),t=this.toVector3(t);var r=this.nodeContainer.clear().lines;return r.push({from:e,to:t,material:this.bottom.materialId,width:this.bottom.pixelLineWidth,dash:0}),r.push({from:e,to:t,material:this.top.materialId,width:this.top.pixelLineWidth,dash:0}),this.nodeContainer}},{key:"getCrossCursorTemplate",value:function(e){var t=(e=this.toVector3(e))[0],r=e[1],n=e[2],o=this.nodeContainer.clear().lines,i=function(e){var i=e.uniBoundSize/2,u={material:e.materialId,width:e.pixelLineWidth,dash:0};o.push(Object.assign({},u,{from:[t-i,r,n],to:[t+i,r,n]})),o.push(Object.assign({},u,{from:[t,r-i,n],to:[t,r+i,n]}))};return i(this.bottom),i(this.top),this.nodeContainer}},{key:"getCustomCursorTemplate",value:function(e,t){switch(t){case n.E.Box:return this.getBoxCursorTemplate(e);case n.E.Triangle:return this.getTriangleCursorTemplate(e);case n.E.Circle:return this.getCircleCursorTemplate(e);default:return this.getCrossCursorTemplate(e)}}},{key:"getCircleCursorTemplate",value:function(e){var t=e[0],r=e[1],n=this.nodeContainer.clear().arcs;return n.push(this.provider.createCircleStroke(t,r,this.bottom.uniRadius,this.bottom.materialId,this.bottom.uniLineWidth,[0,0])),n.push(this.provider.createCircleStroke(t,r,this.top.uniRadius,this.top.materialId,this.top.uniLineWidth,[0,0])),this.nodeContainer}},{key:"getBoxCursorTemplate",value:function(e){var t=(e=this.toVector3(e))[0],r=e[1],n=e[2],o=this.nodeContainer.clear().lines,i=function(e){var i=e.uniBoundSize/2,u={material:e.materialId,width:e.pixelLineWidth,dash:0};o.push(Object.assign({},u,{from:[t-i,r-i,n],to:[t+i,r-i,n]})),o.push(Object.assign({},u,{from:[t+i,r-i,n],to:[t+i,r+i,n]})),o.push(Object.assign({},u,{from:[t+i,r+i,n],to:[t-i,r+i,n]})),o.push(Object.assign({},u,{from:[t-i,r+i,n],to:[t-i,r-i,n]}))};return i(this.bottom),i(this.top),this.nodeContainer}},{key:"getTriangleCursorTemplate",value:function(e){var t=(e=this.toVector3(e))[0],r=e[1],n=e[2],o=this.nodeContainer.clear().lines,i=function(e){var i=e.uniBoundSize/2,u={material:e.materialId,width:e.pixelLineWidth,dash:0};o.push(Object.assign({},u,{from:[t,r+i,n],to:[t+i,r-i,n]})),o.push(Object.assign({},u,{from:[t+i,r-i,n],to:[t-i,r-i,n]})),o.push(Object.assign({},u,{from:[t-i,r-i,n],to:[t,r+i,n]}))};return i(this.bottom),i(this.top),this.nodeContainer}},{key:"updateStyles",value:function(){if(this.scene){var e=this.scene.pixelsToUnits(1);this.bottom.update(e),this.top.update(e)}}},{key:"toVector3",value:function(e){return e?e.length>=3?e:[e[0],e[1],0]:[0,0,0]}}])}();function N(e){return N="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},N(e)}function R(e,t,r){return t=X(t),function(e,t){if(t&&("object"==N(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,D()?Reflect.construct(t,r||[],X(e).constructor):t.apply(e,r))}function D(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(D=function(){return!!e})()}function X(e){return X=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},X(e)}function Y(e,t){return Y=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Y(e,t)}var F=function(e){function t(e,r){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),R(this,t,[e,r])}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Y(e,t)}(t,e),r=t,Object.defineProperty(r,"prototype",{writable:!1}),r;var r}(L);function G(e){return G="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},G(e)}function U(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,V(n.key),n)}}function V(e){var t=function(e,t){if("object"!=G(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!=G(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==G(t)?t:t+""}function Z(e,t,r){return t=W(t),function(e,t){if(t&&("object"==G(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,H()?Reflect.construct(t,r||[],W(e).constructor):t.apply(e,r))}function H(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(H=function(){return!!e})()}function W(e){return W=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},W(e)}function z(e,t){return z=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},z(e,t)}var q=function(e){function t(e,r){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Z(this,t,[e,r])}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&z(e,t)}(t,e),r=t,(n=[{key:"getCapTemplate",value:function(e){return this.getCrossCursorTemplate(e)}},{key:"getCursorTemplate",value:function(e){return this.getCrossCursorTemplate(e)}}])&&U(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(L);function $(e){return $="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},$(e)}function K(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,J(n.key),n)}}function J(e){var t=function(e,t){if("object"!=$(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!=$(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==$(t)?t:t+""}function Q(e,t,r){return t=te(t),function(e,t){if(t&&("object"==$(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,ee()?Reflect.construct(t,r||[],te(e).constructor):t.apply(e,r))}function ee(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(ee=function(){return!!e})()}function te(e){return te=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},te(e)}function re(e,t){return re=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},re(e,t)}var ne=function(e){function t(e,r,o,i){var u;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(u=Q(this,t)).scene=r,u.provider=o,u.logger=window.__CORE__.createLogger("MeasurementEngine:GraphiteRenderer"),u.nodeMeter=null,u.nodeCursor=null,u.cursorType=void 0,u.cursorPoint=void 0,u.projectionsShown=!1,u.onsceneBeforeRender=function(){u.drawCursor(u.cursorPoint,u.cursorType),u.drawMeter(!1),u.updateLabelsPosition()},u.geometryBuildInfo=new P(0),u.nodeMeter=null,u.nodeCursor=null,u.cursorBuilder=n.F.CrossCap,u.svgCursorBuilder=new s(e),u.labelBuilder=new I(i),u.labelBuilder.on("click",(function(){u.projectionsShown?u.hideProjections():u.drawProjections()})),u}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&re(e,t)}(t,e),r=t,(o=[{key:"cursorBuilder",set:function(e){this.meterBuilder=this.getBuilderByType(e)}},{key:"systemCursor",set:function(e){this.svgCursorBuilder.setCursor(e)}},{key:"dispose",value:function(){this.labelBuilder.dispose()}},{key:"activate",value:function(){this.scene.on("beforeRender",this.onsceneBeforeRender),this.labelBuilder.activate(),this.isActive=!0}},{key:"deactivate",value:function(){this.scene.off("beforeRender",this.onsceneBeforeRender),this.isActive=!1,this.labelBuilder.deactivate(),this.hideProjections(),this.clearMeter()}},{key:"drawProjections",value:function(){this.projectionsShown=!0,this.labelBuilder.showProjections(),this.emit("change")}},{key:"hideProjections",value:function(){this.projectionsShown=!1,this.labelBuilder.hideProjections(),this.emit("change")}},{key:"drawMeter",value:function(e,t,r,n){try{this.clearScene(!1),this.geometryBuildInfo.clear(),t&&void 0!==t&&(this.measurementItem=t,this.measurementCursorType=r,this.measurementBuilder=void 0!==n?this.getBuilderByType(n):void 0),e?this.drawMeterWithFitZoom():this.drawMeterWithoutFitZoom()}catch(e){this.logger.LogError("Try draw meter.",e)}}},{key:"clearMeter",value:function(){this.measurementItem=void 0,this.measurementCursorType=void 0,this.labelBuilder.hideLabel(),this.clearScene(!0)}},{key:"drawCursor",value:function(e,t){try{this.clearCursor(),this.geometryBuildInfo.clear(),this.cursorPoint=e,this.cursorType=t,e&&(this.meterBuilder.buildCursor(this.geometryBuildInfo,e,t),this.nodeCursor=this.scene.addNodeItem([this.geometryBuildInfo.toLayerGeometryBuildInfo()],[]))}catch(e){this.logger.LogError("Try draw cursor.",e)}}},{key:"clearCursor",value:function(){this.cursorType=void 0,this.cursorPoint=void 0;var e=null;try{this.nodeCursor&&(e=this.nodeCursor.GetId(),this.scene.removeNodeItem(this.nodeCursor),this.nodeCursor=null)}catch(t){this.logger.LogError("Try clear cursor for nodeId: ".concat(null!=e?e:" is empty",".\nDetail: ").concat(t))}}},{key:"screenPointToScene",value:function(e){return this.scene.viewportToWorld(e)}},{key:"scenePointToScreen",value:function(e){return this.scene.worldToViewport(e)}},{key:"isXYLabel",value:function(e){if(this.labelBuilder.labelXY&&e){var t=e;return this.labelBuilder.labelXY.contains(t)}return!1}},{key:"getBuilderByType",value:function(e){return e===n.F.SquareCap?new F(this.scene,this.provider):new q(this.scene,this.provider)}},{key:"updateLabelsPosition",value:function(){if(this.isActive&&this.measurementItem){var e=this.scene.worldToViewport(this.measurementItem.from),t=this.scene.worldToViewport(this.measurementItem.to);this.labelBuilder.moveLabelXY(e,t,this.measurementItem.xy||0,this.measurementItem.unitName||"mm"),this.labelBuilder.moveLabelX(e,t,this.measurementItem.x||0,this.measurementItem.unitName||"mm"),this.labelBuilder.moveLabelY(e,t,this.measurementItem.y||0,this.measurementItem.unitName||"mm")}}},{key:"clearScene",value:function(e){try{e&&this.clearCursor(),this.nodeMeter&&(this.scene.removeNodeItem(this.nodeMeter),this.nodeMeter=null)}catch(e){this.logger.LogError("Try clear meter.",e)}}},{key:"createLabels",value:function(e,t,r){this.measurementItem&&(this.labelBuilder.labelXY||(this.labelBuilder.createLabelX(e,t,r.x||0,r.unitName||"mm"),this.labelBuilder.createLabelY(e,t,r.y||0,r.unitName||"mm"),this.labelBuilder.createLabelXY(e,t,r.xy||0,r.unitName||"mm")))}},{key:"drawMeterWithoutFitZoom",value:function(){try{if(this.isActive&&this.measurementItem){var e=this.scene.worldToViewport(this.measurementItem.from),t=this.scene.worldToViewport(this.measurementItem.to);this.createLabels(e,t,this.measurementItem),this.createXY(this.geometryBuildInfo,this.measurementItem.from,this.measurementItem.to),this.projectionsShown&&(this.createX(this.geometryBuildInfo,this.measurementItem.from,this.measurementItem.to),this.createY(this.geometryBuildInfo,this.measurementItem.from,this.measurementItem.to)),this.nodeMeter=this.scene.addNodeItem([this.geometryBuildInfo.toLayerGeometryBuildInfo()],[])}}catch(e){this.logger.LogError("Try draw meter with out Fit To Zoom.",e)}}},{key:"drawMeterWithFitZoom",value:function(){var e;try{if(this.isActive&&this.measurementItem){var t=null!==(e=this.scene.mainScene)&&void 0!==e?e:this.scene;if(void 0!==this.measurementItem.fromObjectId&&void 0!==this.measurementItem.toObjectId)t.zoomToFitBoundNodeItems([this.measurementItem.fromObjectId,this.measurementItem.toObjectId],!0);else{var r=this.measurementItem.from,n=this.measurementItem.to,o=[Math.min(r[0],n[0]),Math.min(r[1],n[1]),0,Math.max(r[0],n[0]),Math.max(r[1],n[1]),0];t.zoomToFitBoundBoxes([o],!0)}var i=this.scene.worldToViewport(this.measurementItem.from),u=this.scene.worldToViewport(this.measurementItem.to);this.createLabels(i,u,this.measurementItem),this.createXY(this.geometryBuildInfo,this.measurementItem.from,this.measurementItem.to),this.projectionsShown&&(this.createX(this.geometryBuildInfo,this.measurementItem.from,this.measurementItem.to),this.createY(this.geometryBuildInfo,this.measurementItem.from,this.measurementItem.to)),this.nodeMeter=this.scene.addNodeItem([this.geometryBuildInfo.toLayerGeometryBuildInfo()],[])}}catch(e){this.logger.LogError("Try draw meter with Fit To Zoom.",e)}}},{key:"createXY",value:function(e,t,r){var n;(null!==(n=this.measurementBuilder)&&void 0!==n?n:this.meterBuilder).build(e,{from:t,to:r},this.measurementCursorType),!e.isEmpty&&this.labelBuilder.showLabel()}},{key:"createX",value:function(e,t,r){var n,o;(null!==(n=this.measurementBuilder)&&void 0!==n?n:this.meterBuilder).build(e,{from:t,to:[r[0],t[1],null!==(o=r[2])&&void 0!==o?o:0]},void 0,!0)}},{key:"createY",value:function(e,t,r){var n,o;(null!==(n=this.measurementBuilder)&&void 0!==n?n:this.meterBuilder).build(e,{from:[r[0],t[1],null!==(o=t[2])&&void 0!==o?o:0],to:r},void 0,!0)}}])&&K(r.prototype,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,o}(o.Z);function oe(e){return oe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},oe(e)}function ie(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ue(n.key),n)}}function ue(e){var t=function(e,t){if("object"!=oe(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!=oe(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==oe(t)?t:t+""}function ae(e,t,r){return t=ce(t),function(e,t){if(t&&("object"==oe(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,se()?Reflect.construct(t,r||[],ce(e).constructor):t.apply(e,r))}function se(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(se=function(){return!!e})()}function ce(e){return ce=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},ce(e)}function le(e,t){return le=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},le(e,t)}var fe=new Map,he=function(e){function t(e){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(r=ae(this,t)).maxLength=void 0!==e&&e>0?e:1/0,r.history=new Array,r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&le(e,t)}(t,e),function(e,t,r){return t&&ie(e.prototype,t),r&&ie(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}(t,[{key:"values",value:function(){return this.history.slice()}},{key:"set",value:function(e){var t;if(!e)throw new Error("Item argument shouldnt be empty");this.history.length==this.maxLength&&this.history.pop();var r=null!==(t=e.id)&&void 0!==t?t:this.createId(32);return e.id=r,this.history.unshift(e),this.emit("change"),r}},{key:"get",value:function(e){return this.history.find((function(t){return t.id===e}))}},{key:"delete",value:function(e){var t=this.history.findIndex((function(t){return t.id===e})),r=-1!==t&&1===this.history.splice(t,1).length;return r&&this.emit("change"),r}},{key:"clearAll",value:function(){var e=this.history.length;this.history.length,e&&this.emit("change")}},{key:"toTop",value:function(e){var t=this.history.findIndex((function(t){return t.id===e}));if(t<0)return!1;if(t>0){var r=this.history.splice(t,1)[0];this.history.unshift(r),this.emit("change")}return!0}},{key:"first",value:function(){return this.history.length>0?this.history[0]:void 0}},{key:"createId",value:function(e){for(var t="",r=0;r<e;r++){var n=0+Math.floor(61*Math.random());t+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmopqrstuvwxyz0123456789".substring(n,n+1)}return t}}],[{key:"getOrCreate",value:function(e,r){var n=fe.get(e);return n||(n=new t(r),fe.set(e,n)),n}}])}(o.Z),me=r(41497),de=r(12743),ye="canceled",pe=new de.C(ye),ve={IDLE:[{to:"CAPTURED",where:function(e){return["mousedown"===e.type,0===e.button||2===e.button]}},{to:"IDLE",where:function(e){return["wheel"===e.type]},extend:function(e){return e.transitionType="ZOOM"}},{to:"PAN",where:function(e){return["mouseenter"===e.type,0!==e.buttons]}},{to:"WILL_MEASURE",where:function(e){var t;return["touchstart"===e.type,1==(null===(t=e.touches)||void 0===t?void 0:t.length)]}},{to:"WILL_MEASURE",where:function(e){var t;return["touchend"===e.type,1==(null===(t=e.touches)||void 0===t?void 0:t.length)]}}],CAPTURED:[{to:"IDLE",where:function(e){return["mouseup"===e.type,2===e.button,0===e.buttons]}},{to:"WILL_MEASURE",where:function(e){return["mouseup"===e.type,0===e.button,0===e.buttons]}},{to:"PAN",where:function(e){return["mousemove"===e.type]}}]};ve.WILL_MEASURE=[{to:"MEASURING",where:function(e){return["mousemove"===e.type]}},{to:"MEASURING_CAPTURED",where:function(e){return["mousedown"===e.type,0===e.button||2===e.button]}},{to:"MEASURING",where:function(e){return["wheel"===e.type]},extend:function(e){return e.transitionType="ZOOM"}},{to:"MEASURING",where:function(e){return["touchmove"===e.type]}},{to:"IDLE",where:function(e){return["touchend"===e.type]},extend:function(e){return e.transitionType="CANCELED"}},{to:"IDLE",where:function(e){return["touchstart"===e.type]},extend:function(e){return e.transitionType="CANCELED"}},{to:"IDLE",where:function(e){return["keydown"===e.type,27===e.keyCode]},extend:function(e){return e.transitionType="CANCELED"}},{to:"IDLE",where:function(e){return[e.type===ye]},extend:function(e){return e.transitionType="CANCELED"}}],ve.MEASURING_CAPTURED=[{to:"MEASURING_PAN",where:function(e){return["mousemove"===e.type]}},{to:"IDLE",where:function(e){return["mouseup"===e.type,2===e.button,0===e.buttons]},extend:function(e){return e.transitionType="CANCELED"}},{to:"IDLE",where:function(e){return["mouseup"===e.type,0===e.button,0===e.buttons]},extend:function(e){return e.transitionType="DID_MEASURE"}},{to:"IDLE",where:function(e){return["keydown"===e.type,27===e.keyCode]},extend:function(e){return e.transitionType="CANCELED"}},{to:"IDLE",where:function(e){return[e.type===ye]},extend:function(e){return e.transitionType="CANCELED"}}],ve.MEASURING=[{to:"MEASURING",where:function(e){return["mousemove"===e.type]}},{to:"MEASURING_LEAVE_WORKSPACE",where:function(e){return["mouseleave"===e.type]}},{to:"MEASURING_CAPTURED",where:function(e){return["mousedown"===e.type,0===e.button||2===e.button]}},{to:"MEASURING",where:function(e){return["wheel"===e.type]},extend:function(e){return e.transitionType="ZOOM"}},{to:"MEASURING",where:function(e){return["touchmove"===e.type]}},{to:"IDLE",where:function(e){return["touchend"===e.type]},extend:function(e){return e.transitionType="DID_MEASURE"}},{to:"IDLE",where:function(e){return["keydown"===e.type,27===e.keyCode]},extend:function(e){return e.transitionType="CANCELED"}},{to:"IDLE",where:function(e){return[e.type===ye]},extend:function(e){return e.transitionType="CANCELED"}}],ve.MEASURING_LEAVE_WORKSPACE=[{to:"MEASURING",where:function(e){return["mouseenter"===e.type,0===e.buttons]}},{to:"MEASURING_PAN",where:function(e){return["mouseenter"===e.type,0!==e.buttons]}},{to:"IDLE",where:function(e){return["keydown"===e.type,27===e.keyCode]},extend:function(e){return e.transitionType="CANCELED"}},{to:"IDLE",where:function(e){return[e.type===ye]},extend:function(e){return e.transitionType="CANCELED"}}],ve.MEASURING_PAN=[{to:"MEASURING_PAN",where:function(e){return["mousemove"===e.type]}},{to:"MEASURING",where:function(e){return["mouseup"===e.type,0===e.buttons]}},{to:"MEASURING_LEAVE_WORKSPACE",where:function(e){return["mouseleave"===e.type]}},{to:"IDLE",where:function(e){return["keydown"===e.type,27===e.keyCode]},extend:function(e){return e.transitionType="CANCELED"}},{to:"IDLE",where:function(e){return[e.type===ye]},extend:function(e){return e.transitionType="CANCELED"}}],ve.PAN=[{to:"IDLE",where:function(e){return["mouseup"===e.type,0===e.buttons]}},{to:"IDLE",where:function(e){return["mouseleave"===e.type]}}];var be=r(19577);function ge(e){return ge="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ge(e)}function we(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Ee(n.key),n)}}function Ee(e){var t=function(e,t){if("object"!=ge(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!=ge(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==ge(t)?t:t+""}var Ie=function(){return e=function e(t,r,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.unitFactor=n,this.from=t.slice(),this.to=t.slice(),this.unitName=r},(t=[{key:"from",get:function(){return this._from},set:function(e){this._from=this.createItemPointProxy(e)}},{key:"to",get:function(){return this._to},set:function(e){this._to=this.createItemPointProxy(e)}},{key:"unitName",get:function(){return this._unitName},set:function(e){this._unitName=e,this.onMeasurementItemChanged()}},{key:"toAppModel",value:function(){return void 0===this._measurementItem&&(this._measurementItem={}),this._measurementItem.id=this.id,this._measurementItem.from=this.from.slice(),this._measurementItem.fromObjectId=this.fromObjectId,this._measurementItem.to=this.to.slice(),this._measurementItem.toObjectId=this.toObjectId,this._measurementItem.unitName=this.unitName,this._measurementItem.unitMult=this.unitMult,this._measurementItem.x=this.x,this._measurementItem.y=this.y,this._measurementItem.xy=this.xy,this._measurementItem}},{key:"createItemPointProxy",value:function(e){var t=this;return new Proxy(e,{set:function(e,r,n){var o=e[r]!==n,i=Reflect.set(e,r,n);return o&&t.onMeasurementItemChanged(),i}})}},{key:"onMeasurementItemChanged",value:function(){var e="mil"===this.unitName?100/this.unitFactor:2.54/this.unitFactor;this.unitMult=e,this.x=e*Math.abs(this.from[0]-this.to[0]),this.y=e*Math.abs(this.from[1]-this.to[1]),this.xy=e*Math.sqrt(Math.pow(this.from[0]-this.to[0],2)+Math.pow(this.from[1]-this.to[1],2))}}])&&we(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}(),Se=r(65345);function _e(e){return _e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_e(e)}function Ce(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ke(n.key),n)}}function ke(e){var t=function(e,t){if("object"!=_e(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!=_e(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==_e(t)?t:t+""}function Oe(e,t,r){return t=Me(t),function(e,t){if(t&&("object"==_e(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,Pe()?Reflect.construct(t,r||[],Me(e).constructor):t.apply(e,r))}function Pe(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Pe=function(){return!!e})()}function Me(e){return Me=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Me(e)}function je(e,t){return je=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},je(e,t)}var xe=["mousedown","mouseup","mousemove","wheel","mouseleave","mouseenter","touchstart","touchmove","touchend"],Ae=["keydown","keyup"],Be=function(e){function t(e,r,o,i,u){var a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(a=Oe(this,t)).view=e,a.renderer=r,a.history=o,a.unitFactor=i,a.calculateOffset=u,a.measurementItem=void 0,a.logger=window.__CORE__.createLogger("MeasurementEngine:FreeModeOnlyController"),a.unitName="",a.clientPoint=[0,0,0],a.dispatchFsmEvent=function(e){a.fsm.dispatch(e)},a.onIdle=function(e){if(e.transitionType)switch(e.transitionType){case"ZOOM":break;case"CANCELED":a.cancelMeasurement();break;case"DID_MEASURE":a.commitMeasurement()}},a.onWillMeasure=function(e){try{a.renderer.systemCursor=n.E.None;var t=a.setClientPoint(e),r=a.renderer.screenPointToScene(t);a.measurementItem=new Ie(r,a.unitName,a.unitFactor),a.renderer.hideProjections(),a.renderer.drawMeter(!1,a.measurementItem),a.emit("willMeasure",a.measurementItem.toAppModel())}catch(e){a.logger.LogError("Start measurement error.",e),a.dispatchFsmEvent(pe)}},a.onMeasuring=function(e){try{if("ZOOM"!==e.transitionType&&a.measurementItem){var t=a.setClientPoint(e),r=a.renderer.screenPointToScene(t);a.measurementItem.to[0]=r[0],a.measurementItem.to[1]=r[1],a.renderer.drawMeter(!1,a.measurementItem)}}catch(e){a.logger.LogError("Measuring error.",e),a.dispatchFsmEvent(pe)}},a.emitChangeHistory=function(){a.emit("changeHistory",{measurements:a.history.values().map((function(e){return e.toAppModel()}))})},a.onChangeUnit=function(){var e;a.unitName=null!==(e=be.Z.get())&&void 0!==e?e:"mm",a.history.values().forEach((function(e){return e.unitName=a.unitName}))},a.fsm=new me.Z("IDLE",ve),window.__CORE__.bus.on("HelpPanel:changeUnit",a.onChangeUnit),a.onChangeUnit(),a}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&je(e,t)}(t,e),r=t,o=[{key:"activate",value:function(){var e=this;this.emitChangeHistory(),this.history.on("change",this.emitChangeHistory),xe.forEach((function(t){return e.view.addEventListener(t,e.dispatchFsmEvent)})),Ae.forEach((function(t){return e.view.addEventListener(t,e.dispatchFsmEvent)})),this.fsm.on("IDLE",this.onIdle),this.fsm.on("WILL_MEASURE",this.onWillMeasure),this.fsm.on("MEASURING",this.onMeasuring),this.renderer.activate(),this.renderer.systemCursor=n.E.Cross,this.select(void 0,!1)}},{key:"deactivate",value:function(){var e=this;this.history.off("change",this.emitChangeHistory),this.fsm.dispatch(pe),this.measurementItem=void 0,this.renderer.clearMeter(),this.renderer.systemCursor=n.E.Default,this.renderer.deactivate(),xe.forEach((function(t){return e.view.removeEventListener(t,e.dispatchFsmEvent)})),Ae.forEach((function(t){return e.view.removeEventListener(t,e.dispatchFsmEvent)})),this.fsm.off("IDLE",this.onIdle),this.fsm.off("WILL_MEASURE",this.onWillMeasure),this.fsm.off("MEASURING",this.onMeasuring)}},{key:"dispose",value:function(){this.deactivate(),window.__CORE__.bus.off("HelpPanel:changeUnit",this.onChangeUnit)}},{key:"select",value:function(e,t){this.dispatchFsmEvent(pe),this.measurementItem=void 0===e?this.history.first():this.history.get(e),this.measurementItem?this.renderer.drawMeter(t,this.measurementItem):this.renderer.clearMeter(),this.measurementItem&&this.emit("selectMeasure",this.measurementItem.toAppModel())}},{key:"setClientPoint",value:function(e){var t,r,n,o,i,u,a,s,c=this.calculateOffset?(0,Se.Z)({x:(null===(r=null===(t=e.touches)||void 0===t?void 0:t[0])||void 0===r?void 0:r.clientX)||e.clientX,y:(null===(o=null===(n=e.touches)||void 0===n?void 0:n[0])||void 0===o?void 0:o.clientY)||e.clientY},this.view):{x:(null===(u=null===(i=e.touches)||void 0===i?void 0:i[0])||void 0===u?void 0:u.clientX)||e.clientX,y:(null===(s=null===(a=e.touches)||void 0===a?void 0:a[0])||void 0===s?void 0:s.clientY)||e.clientY};return this.clientPoint[0]=c.x,this.clientPoint[1]=c.y,this.clientPoint}},{key:"cancelMeasurement",value:function(){this.measurementItem=void 0,this.renderer.systemCursor=n.E.Cross,this.renderer.clearMeter(),this.emit("cancelMeasure")}},{key:"commitMeasurement",value:function(){this.renderer.systemCursor=n.E.Cross,this.measurementItem&&(this.history.set(this.measurementItem)?this.emit("didMeasure",this.measurementItem.toAppModel()):(this.measurementItem=void 0,this.renderer.clearMeter()))}}],o&&Ce(r.prototype,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,o}(o.Z),Te=r(62755),Le=r(32699);r(61924);var Ne=r(70315),Re=r(36035),De=r(4348),Xe=r(39485),Ye=function e(t){return{mainScene:t.parentScene?e(t.parentScene):void 0,add2DMaterial:function(e){var r=t.getMaterials();if(r){var n=r.findIndex((function(t){return!t.Bordered&&!t.GrayscaleMesh&&!t.Hatching&&!t.Offset2D&&!t.OnTop&&t.Diffuse.every((function(t,r){return t===e.Diffuse[r]}))}));if(n>=0)return n}return t.addMaterial(e)},addNodeItem:function(e,r){if(1!==e.length)throw new Error("itemGeometry parameter should have length === 1");var n=e[0],o=t.addItem(n.GetLayerIndex(),n.GetUnis(),n.GetArcs(),n.GetPolygons(),n.GetLabels(),n.GetLines(),r);return t.setDirty(!0),o},removeNodeItem:function(e){t.removeItem(e),t.setDirty(!0)},getNodeItemById:function(e){return t.getNodeItemById(e)},viewportToWorld:function(e){return t.viewportToWorld(e)},worldToViewport:function(e){return t.worldToViewport(e)},pixelsToUnits:function(e){return t.pixelsToUnits(e)},on:function(e,r){return t.on(e,r)},off:function(e,r){return t.off(e,r)},once:function(e,r){return t.off(e,r)},emit:function(e){for(var r=arguments.length,n=new Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];return t.emit.apply(t,[e].concat(n))},eventNames:function(){return t.eventNames()},zoomToFitBoundNodeItems:function(e){var r,n=null!==(r=t.parentScene)&&void 0!==r?r:t,o={nodes:[n.getNodeItemById(e[0]),n.getNodeItemById(e[1])],renderMode:De.Z.Render2D,useOffsets:!0};(0,Xe.lE)(n,o)},zoomToFitBoundBoxes:function(e){var r,n={rects:e,renderMode:De.Z.Render2D,useOffsets:!0},o=null!==(r=t.parentScene)&&void 0!==r?r:t;(0,Xe.lE)(null!=o?o:t,n)}}};const Fe=function(e){var t={createMaterial:function(e){return new Le.Z(e,Ne.lc.None,!1,!1,!1)},createCircleStroke:function(e,t,r,n,o,i){return Re.Z.createCircleStroke(e,t,r,n,o,i)}};return{scene:Ye(e),provider:t}};function Ge(e){return Ge="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ge(e)}function Ue(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Ve(n.key),n)}}function Ve(e){var t=function(e,t){if("object"!=Ge(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!=Ge(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Ge(t)?t:t+""}function Ze(e,t,r){return t=ze(t),function(e,t){if(t&&("object"==Ge(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,He()?Reflect.construct(t,r||[],ze(e).constructor):t.apply(e,r))}function He(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(He=function(){return!!e})()}function We(){return We="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=function(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=ze(e)););return e}(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(arguments.length<3?e:r):o.value}},We.apply(null,arguments)}function ze(e){return ze=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},ze(e)}function qe(e,t){return qe=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},qe(e,t)}var $e=function(e){function t(e){var r,n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var o=e.view,i=e.scene,u=e.unitFactor,a=e.grahiteEntitiesProvider;if(void 0===i)throw new Te.P("Scene should be defined");var s=void 0===a;if(void 0===a){var c=Fe(i);i=c.scene,a=c.provider}var l=null!==(n=e.svgScene)&&void 0!==n?n:t.createSvgScene(o),f=t.createRenderer(o,i,a,l),h=t.createHistory(e);return(r=Ze(this,t,[o,f,h,u,s])).disposed=!1,e.svgScene||(r.svgScene=l),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&qe(e,t)}(t,e),function(e,t,r){return t&&Ue(e.prototype,t),r&&Ue(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}(t,[{key:"dispose",value:function(){var e;this.disposed||(We(ze(t.prototype),"dispose",this).call(this),this.disposed=!0,this.renderer.dispose(),null===(e=this.svgScene)||void 0===e||e.remove())}}],[{key:"createSvgScene",value:function(e){var t,r,n=h.createElement("svg");return h.setAttribute(n,{id:"Measurment_Scene",style:"position: absolute; left: 0px; top: 0px; width: 100%; height: 100%"}),null===(r=null===(t=e.querySelector("canvas"))||void 0===t?void 0:t.parentNode)||void 0===r||r.appendChild(n),n}},{key:"createRenderer",value:function(e,t,r,o){var i=new ne(e,t,r,o);return i.cursorBuilder=n.F.CrossCap,i}},{key:"createHistory",value:function(e){var t=e.documentName,r=e.historyMaxLength;return he.getOrCreate(t,r)}}])}(Be),Ke=r(10311);function Je(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}const Qe=(0,window.__APP__.library.Vuex.createStore)({state:{items:[],result:[],history:[],activeModeId:"",modes:[],enabledModes:[]},mutations:{setItems:function(e,t){e.items=t},setResult:function(e,t){e.result=t},addHistoryItem:function(e,t){var r;e.history=[t].concat(function(e){if(Array.isArray(e))return Je(e)}(r=e.history)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(r)||function(e,t){if(e){if("string"==typeof e)return Je(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Je(e,t):void 0}}(r)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())},setHistory:function(e,t){e.history=t},setActiveMode:function(e,t){e.activeModeId=t},setModes:function(e,t){e.modes=t},setEnabledModes:function(e,t){e.enabledModes=t}},getters:{getHistory:function(e){return e.history},getModes:function(e){return e.modes.filter((function(t){return e.enabledModes.includes(t.id)}))}}});var et=r(77826),tt={class:"measurement-section"},rt={key:0,class:"measurement-section__row"},nt={key:1,class:"measurement-section__row"},ot=r(77453);const it={name:"AppMeasurementItem",components:{AfsText:ot.A},props:{primaryTitle:{type:Boolean,default:!1},isActive:{type:Boolean,default:!1},isDisabled:{type:Boolean,default:!1},isRow:{type:Boolean,default:!1}}};var ut=r(46021);function at(e){return at="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},at(e)}function st(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function ct(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=at(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!=at(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==at(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const lt={name:"MeasurementSection",components:{Item:(0,ut.Z)(it,[["render",function(e,t,r,n,o,i){var u=(0,Ke.resolveComponent)("AfsText");return(0,Ke.openBlock)(),(0,Ke.createElementBlock)("div",{class:(0,Ke.normalizeClass)(["app-item",{"is-active":r.isActive,"is-disabled":r.isDisabled,"app-item_is-row":r.isRow}])},[(0,Ke.createVNode)(u,{class:(0,Ke.normalizeClass)(["app-item__title",{"app-item__title_primary":r.primaryTitle}]),type:"title"},{default:(0,Ke.withCtx)((function(){return[(0,Ke.renderSlot)(e.$slots,"title",{},void 0,!0)]})),_:3},8,["class"]),(0,Ke.createVNode)(u,{class:"app-item__text"},{default:(0,Ke.withCtx)((function(){return[(0,Ke.renderSlot)(e.$slots,"text",{},void 0,!0)]})),_:3})],2)}],["__scopeId","data-v-24e96402"]])},computed:function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?st(Object(r),!0).forEach((function(t){ct(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):st(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},(0,window.__APP__.library.Vuex.mapState)(["items","result"]))},ft=(0,ut.Z)(lt,[["render",function(e,t,r,n,o,i){var u=(0,Ke.resolveComponent)("Item");return(0,Ke.openBlock)(),(0,Ke.createElementBlock)("div",tt,[e.items.length?((0,Ke.openBlock)(),(0,Ke.createElementBlock)("div",rt,[((0,Ke.openBlock)(!0),(0,Ke.createElementBlock)(Ke.Fragment,null,(0,Ke.renderList)(e.items,(function(e){return(0,Ke.openBlock)(),(0,Ke.createBlock)(u,{key:e.id,"is-disabled":e.isDisabled,"is-active":e.isActive},{title:(0,Ke.withCtx)((function(){return[(0,Ke.createTextVNode)((0,Ke.toDisplayString)(e.name),1)]})),text:(0,Ke.withCtx)((function(){return[(0,Ke.createTextVNode)((0,Ke.toDisplayString)(e.text),1)]})),_:2},1032,["is-disabled","is-active"])})),128))])):(0,Ke.createCommentVNode)("v-if",!0),e.result.length?((0,Ke.openBlock)(),(0,Ke.createElementBlock)("div",nt,[((0,Ke.openBlock)(!0),(0,Ke.createElementBlock)(Ke.Fragment,null,(0,Ke.renderList)(e.result,(function(e){return(0,Ke.openBlock)(),(0,Ke.createBlock)(u,{key:e.id,"primary-title":"","is-row":""},{title:(0,Ke.withCtx)((function(){return[(0,Ke.createTextVNode)((0,Ke.toDisplayString)(e.name),1)]})),text:(0,Ke.withCtx)((function(){return[(0,Ke.createTextVNode)((0,Ke.toDisplayString)(e.text),1)]})),_:2},1024)})),128))])):(0,Ke.createCommentVNode)("v-if",!0)])}]]);var ht={class:"measurement-history-section"},mt={class:"measurement-history-section__title"},dt=["onClick"],yt=r(91261),pt=r(75419),vt=r(74839),bt=window.__APP__.analytics,gt=window.__APP__.library.i18n.t;const wt={name:"AppMeasurementHistorySection",components:{AfsContextMenu:yt.C,AfsText:ot.A},directives:{hint:pt.h},props:{items:{type:Array,default:function(){return[]}}},data:function(){return{hintText:null,t:gt}},computed:{hintId:function(){return(0,vt.g)()},hintConfig:function(){return{type:"hint",id:this.hintId,modifiers:{y:"bottom",x:"center"},offset:8,initWidth:190}}},methods:{onSelect:function(e){this.$emit("select",e),bt.dispatchPanelsEvent("Measurement",{action:"Navigate"})},onHintOpen:function(e){var t=this;return function(){t.hintText=e.hintText}},onHintClose:function(){var e=this;return function(){e.hintText=null}}}},Et=(0,ut.Z)(wt,[["render",function(e,t,r,n,o,i){var u=(0,Ke.resolveComponent)("AfsText"),a=(0,Ke.resolveComponent)("AfsContextMenu"),s=(0,Ke.resolveDirective)("hint");return(0,Ke.openBlock)(),(0,Ke.createElementBlock)("div",ht,[(0,Ke.createElementVNode)("span",mt,(0,Ke.toDisplayString)(e.t("viewer.engines.measurement.prevMeasurements")),1),((0,Ke.openBlock)(!0),(0,Ke.createElementBlock)(Ke.Fragment,null,(0,Ke.renderList)(r.items,(function(e){return(0,Ke.withDirectives)(((0,Ke.openBlock)(),(0,Ke.createElementBlock)("div",{key:e.id,class:"measurement-history-section__item",onClick:function(t){return i.onSelect(e)}},[(0,Ke.createVNode)(u,{ellipsis:""},{default:(0,Ke.withCtx)((function(){return[(0,Ke.createTextVNode)((0,Ke.toDisplayString)(e.text),1)]})),_:2},1024)],8,dt)),[[s,{id:i.hintId,delay:200,onOpen:i.onHintOpen(e),onClose:i.onHintClose(e)}]])})),128)),(0,Ke.createVNode)(a,(0,Ke.normalizeProps)((0,Ke.guardReactiveProps)(i.hintConfig)),{default:(0,Ke.withCtx)((function(){return[((0,Ke.openBlock)(!0),(0,Ke.createElementBlock)(Ke.Fragment,null,(0,Ke.renderList)(e.hintText,(function(e,t){return(0,Ke.openBlock)(),(0,Ke.createElementBlock)("div",{key:t+e.text,class:"measurement-history-section__hint"},[(0,Ke.createVNode)(u,{class:"measurement-history-section__hint-title",tag:"span"},{default:(0,Ke.withCtx)((function(){return[(0,Ke.createTextVNode)((0,Ke.toDisplayString)(e.title),1)]})),_:2},1024),(0,Ke.createVNode)(u,{tag:"span"},{default:(0,Ke.withCtx)((function(){return[(0,Ke.createTextVNode)((0,Ke.toDisplayString)(e.text),1)]})),_:2},1024)])})),128))]})),_:1},16)])}]]);var It={class:"app-mode-switcher"};const St={name:"AppModeSwitcher",components:{AfsTabs:r(15938).Z},props:{items:{type:Array,default:function(){return[]}}},methods:{onChange:function(e){var t=e.find((function(e){return e.isActive}));this.$emit("change-mode",t)}}},_t=(0,ut.Z)(St,[["render",function(e,t,r,n,o,i){var u=(0,Ke.resolveComponent)("AfsTabs");return(0,Ke.openBlock)(),(0,Ke.createElementBlock)("div",It,[(0,Ke.createVNode)(u,{"model-value":r.items,"onUpdate:modelValue":i.onChange},null,8,["model-value","onUpdate:modelValue"])])}]]);var Ct=["id"],kt={name:"Measurements"};const Ot=Object.assign(kt,{props:["id","manager"],setup:function(e){var t=e,r=(0,window.__APP__.library.Vuex.useStore)(),n=(0,Ke.computed)((function(){return r.getters.getModes})),o=(0,Ke.computed)((function(){return r.getters.getHistory})),i=function(e){t.manager.emit("select",e)},u=function(e){t.manager.setActiveModeId(e.id),t.manager.emit("changeMode",e)};return function(e,r){return(0,Ke.openBlock)(),(0,Ke.createElementBlock)("div",{id:t.id,class:"measurement-panel"},[(0,Ke.unref)(n).length&&(0,Ke.unref)(n).length>1?((0,Ke.openBlock)(),(0,Ke.createBlock)((0,Ke.unref)(_t),{key:0,items:(0,Ke.unref)(n),onChangeMode:u},null,8,["items"])):(0,Ke.createCommentVNode)("v-if",!0),(0,Ke.createVNode)((0,Ke.unref)(ft)),(0,Ke.unref)(o).length?((0,Ke.openBlock)(),(0,Ke.createBlock)((0,Ke.unref)(Et),{key:1,items:(0,Ke.unref)(o),onSelect:i},null,8,["items"])):(0,Ke.createCommentVNode)("v-if",!0)],8,Ct)}}});function Pt(e){return Pt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Pt(e)}function Mt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,jt(n.key),n)}}function jt(e){var t=function(e,t){if("object"!=Pt(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!=Pt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Pt(t)?t:t+""}function xt(e,t,r){return t=Bt(t),function(e,t){if(t&&("object"==Pt(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,At()?Reflect.construct(t,r||[],Bt(e).constructor):t.apply(e,r))}function At(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(At=function(){return!!e})()}function Bt(e){return Bt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Bt(e)}function Tt(e,t){return Tt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Tt(e,t)}var Lt=window.__APP__.library.i18n.t,Nt=function(e){function t(e){var r,n,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(r=xt(this,t)).initialized=!1,Qe.commit("setModes",e),Qe.commit("setActiveMode",null!==(o=null===(n=e.find((function(e){return e.isActive})))||void 0===n?void 0:n.id)&&void 0!==o?o:e[0].id),r.clearItems(),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Tt(e,t)}(t,e),r=t,n=[{key:"init",value:function(e){var t,r=null===(t=document.querySelector("#".concat(e)))||void 0===t?void 0:t.parentNode;if(!r)throw new Error("Mount element has not found.");this.initialized=!0,this.app=(0,Ke.createApp)(Ot,{id:e,manager:this}).use(Qe).mount(r)}},{key:"getActiveModeId",value:function(){return Qe.state.activeModeId}},{key:"setActiveModeId",value:function(e){var t=Qe.state.modes.map((function(t){return Object.assign(Object.assign({},t),{isActive:t.id===e})}));Qe.commit("setActiveMode",e),Qe.commit("setModes",t)}},{key:"setEnabledModes",value:function(e){Qe.commit("setEnabledModes",e)}},{key:"setItem",value:function(e,t){var r=this,n=Qe.state.items.map((function(n,o){return t===o?r.convertItem(e,t):(n.isActive=!1,n.isDisabled&&(n.isDisabled=!1,n.text="Select on Design"),n)}));Qe.commit("setItems",n)}},{key:"clearItems",value:function(){var e={id:(0,et.Z)(),name:Lt("viewer.engines.measurement.items.p1"),text:Lt("viewer.engines.measurement.items.fallback"),isActive:!0,isDisabled:!1};this.emit("convertItem",{index:0,converted_1:e});var t={id:(0,et.Z)(),name:Lt("viewer.engines.measurement.items.p2"),text:"...",isActive:!1,isDisabled:!0};this.emit("convertItem",{index:1,converted_2:t}),Qe.commit("setItems",[e,t])}},{key:"setResult",value:function(e){var t=e.unitName,r=e.xy,n=e.x,o=e.y,i=new Array;i.push({id:(0,et.Z)(),name:Lt("viewer.engines.measurement.results.disXY"),text:"".concat(r.toFixed(2)).concat(t)}),i.push({id:(0,et.Z)(),name:Lt("viewer.engines.measurement.results.disX"),text:"".concat(n.toFixed(2)).concat(t)}),i.push({id:(0,et.Z)(),name:Lt("viewer.engines.measurement.results.disY"),text:"".concat(o.toFixed(2)).concat(t)}),Qe.commit("setResult",i)}},{key:"clearResult",value:function(){Qe.commit("setResult",[])}},{key:"setHistory",value:function(e){var t=this,r=e.map((function(e){var r,n=e.unitName,o=e.xy,i=e.x,u=e.y;return{id:null!==(r=e.id)&&void 0!==r?r:"",text:"XY: ".concat(o.toFixed(2)).concat(n," /\n                  X: ").concat(i.toFixed(2)).concat(n," /\n                  Y: ").concat(u.toFixed(2)).concat(n),hintText:[0,1].map((function(r){var n=t.convertItem(e,r);return{title:n.name,text:n.text}}))}}));Qe.commit("setHistory",r)}},{key:"clearHistory",value:function(){Qe.commit("setHistory",[])}},{key:"convertItem",value:function(e,t){var r=0===t?e.from:e.to,n=r[0]*e.unitMult,o=r[1]*e.unitMult,i=e.unitName,u={id:(0,et.Z)(),name:"Point ".concat(t+1),text:"".concat(n.toFixed(2)).concat(i,"/ ").concat(o.toFixed(2)).concat(i),isActive:!1,isDisabled:!1};return this.emit("convertItem",{item:e,index:t,converted:u}),u}}],n&&Mt(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(o.Z);function Rt(e){return Rt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Rt(e)}function Dt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Xt(n.key),n)}}function Xt(e){var t=function(e,t){if("object"!=Rt(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!=Rt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Rt(t)?t:t+""}var Yt=function(){return e=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.metaInfo={name:"Measurement",comment:"",dependencies:[]},this.events=[],this.logger=t.createLogger("MeasurementEngine")},(t=[{key:"setup",value:function(){return Promise.resolve()}},{key:"createApp",value:function(e){return this.logger.LogInfo("Create app."),new Nt(e)}},{key:"createHistory",value:function(e,t){return this.logger.LogInfo("Create history."),he.getOrCreate(e,t)}},{key:"createGraphiteSceneRenderer",value:function(e,t,r){this.logger.LogInfo("Create Graphite measurement renderer.");var n=Fe(t);return this.createGraphiteSceneRenderer2(e,n.scene,n.provider,r)}},{key:"createGraphiteSceneRenderer2",value:function(e,t,r,n){return this.logger.LogInfo("Create Graphite measurement renderer."),new ne(e,t,r,n)}},{key:"createGraphiteSceneFreeModeOnlyController",value:function(e){return this.logger.LogInfo("Create Graphite free mode only controller."),new $e(e)}}])&&Dt(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}();window.__CORE__&&window.__CORE__.addModule({type:"Engine",description:"",create:function(e){return new Yt(e)}})},10311:e=>{e.exports=Vue}},e=>{e.O(0,[66951,21759],(()=>e(e.s=2929))),e.O()}]);