<!doctype html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Document</title>
  <script>
    // Google Analytics Mock - prevents app.js crashes
    window.dataLayer = window.dataLayer || [];
    window.gtag = function () { };
  </script>
  <script defer="defer" src="js/runtime.js?1761730629786"></script>
  <script defer="defer" src="js/vendors.js?1761730629786"></script>

  <!-- External Libraries (loaded before webpack chunks) -->
  <script defer="defer" src="js/ViewerUtils.js"></script> <!-- Shared utilities -->
  
  <!-- Core Modules (must load in order before components) -->
  <script defer="defer" src="js/core/ViewerEventBus.js"></script> <!-- EventBus first -->
  <script defer="defer" src="js/core/ViewerStore.js"></script>
  <script defer="defer" src="js/core/ViewerWASM.js"></script>
  <script defer="defer" src="js/core/ViewerAppConfig.js"></script> <!-- App config -->
  <script defer="defer" src="js/core/ViewerViewManager.js"></script>
  <script defer="defer" src="js/core/ViewerPluginManager.js"></script> <!-- Plugin manager -->
  <script defer="defer" src="js/app/ViewerAppMethods.js"></script> <!-- App methods helpers -->
  <script defer="defer" src="js/core/ViewerDesignResolver.js"></script> <!-- Design resolver wrapper -->
  <script defer="defer" src="js/i18n/ViewerI18n.js"></script> <!-- I18n messages -->
  <script defer="defer" src="js/core/ViewerTheme.js"></script> <!-- Theme utilities -->
  <script defer="defer" src="js/core/ViewerCoreBundle.js"></script> <!-- Core barrel -->
  
  <!-- ViewerComponents Module Files (must load in order) -->
  <script defer="defer" src="js/components/ViewerCore.js"></script> <!-- Core utilities first -->
  <script defer="defer" src="js/components/ViewerGrid.js"></script>
  <script defer="defer" src="js/components/ViewerTypography.js"></script>
  <script defer="defer" src="js/components/ViewerSidebar.js"></script>
  <script defer="defer" src="js/components/ViewerLoader.js"></script>
  <script defer="defer" src="js/components/ViewerHeader.js"></script>
  <script defer="defer" src="js/components/ViewerMisc.js"></script>
  <!-- ViewerComponents split modules -->
  <script defer="defer" src="js/ViewerComponents/core.js"></script>
  <script defer="defer" src="js/ViewerComponents/layout.js"></script>
  <script defer="defer" src="js/ViewerComponents/status.js"></script>
  <script defer="defer" src="js/ViewerComponents/header.js"></script>
  <script defer="defer" src="js/ViewerComponents/notification.js"></script>
  <script defer="defer" src="js/ViewerComponents/misc.js"></script>
  <script defer="defer" src="js/ViewerComponents/layout-notifier.js"></script>
  <script defer="defer" src="js/ViewerComponents/index.js"></script>
  <script defer="defer" src="js/Logger.js"></script> <!-- Logger library -->
  <script defer="defer" src="js/ComponentFactory.js"></script> <!-- ComponentFactory library -->


  <!-- Webpack Bridge Chunks -->
  <script defer="defer" src="js/app/vue-bridge.js"></script> <!-- Vue bridge -->
  <script defer="defer" src="js/app/ViewerComponents-bridge.js"></script> <!-- ViewerComponents bridge -->
  <script defer="defer" src="js/app/Logger-bridge.js"></script> <!-- Logger bridge -->
  <script defer="defer" src="js/app/ComponentFactory-bridge.js"></script> <!-- ComponentFactory bridge -->

  <!-- App Chunks -->
  <script defer="defer" src="js/app/ViewerApp.js"></script> <!-- Main viewer application -->
  <script defer="defer" src="js/app/entry.js"></script>
  <link href="styles/appStyles.css?1761730629786" rel="stylesheet">
</head>

<body>
  <script>
    // Bridge script injected by Go Altium Viewer
    window.addEventListener('message', function (e) {
      // Log all messages to see what's happening
      console.log("Msg received:", e.data);
      if (e.data && e.data.message === 'loadWidget') {
        console.log("Bridge: Received loadWidget", e.data);
        var attempts = 0;
        var ii = setInterval(function () {
          var appExists = !!window.__APP__;
          var eventsExists = appExists && !!window.__APP__.parentEvents;
          console.log("Bridge check " + attempts + ": __APP__=" + appExists + ", parentEvents=" + eventsExists);

          if (eventsExists) {
            clearInterval(ii);
            console.log("Bridge: EVENTS DETECTED. Waiting 1s to ensure listener is matched...");
            setTimeout(function () {
              console.log("Bridge: Emitting app:load via postMessage to window");
              // Clone data and change message type
              var evtData = Object.assign({}, e.data);
              evtData.message = 'app:load';
              window.postMessage(evtData, '*');
              console.log("Bridge: PostMessage done.");
            }, 1);
          }
          attempts++;
          if (attempts > 100) { // 5 seconds
            clearInterval(ii);
            console.error("Bridge: Timeout waiting for parentEvents");
          }
        }, 50);
      }
    });
  </script>
  <div id="viewer-app"></div>
  <script src="js/vue.js?3.2.33"></script>
</body>

</html>